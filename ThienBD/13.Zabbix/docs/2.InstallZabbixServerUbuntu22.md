# Cài đặt Zabbix Server trên Ubuntu 22.04

# 1.Mô hình 
![alt text](../imgs/5.png)

**Máy Zabbix Server**   
Ubuntu Server 22.04   
IP 192.168.74.104

**Máy Web Server**  
Ubuntu Server 22.04  
IP 192.168.74.105

**Máy Windows Server**  
Windows server 2019  
IP 192.168.74.106  

**Giám sát Web Server sử dụng Zabbix Agent**  
**Giám sát Windows Server sử dụng Zabbix Agent/SMNP**

# 2.Cài đặt Zabbix server

## 2.1. Thiết lập IP tĩnh cho Zabbix server

Ta cấu hình trong file netpaln với IP:192.168.74.104

![alt text](../imgs/6.png)

## 2.2.Cài đặt Aapache HTTP Server

- Cập nhật lại hệ thống 
```
sudo apt update
```
- Cài đặt apache2 
```
sudo apt -y install apache2
```
- Kiểm tra các gói apache đã cài đặt
```
sudo apt list --installed | grep apache2
```
- Restart và bật apache chạy ngay khi khởi động 
```
sudo systemctl restart apache2
sudo systemctl enable apache2
```
- Kiểm tra trạng thái apache
```
sudo systemctl status apache2
```

Truy cập link `http://192.168.74.104` đã thấy hoạt động

![alt text](../imgs/7.png)


## 2.3.Cài đặt MariaDB

- Cài đặt mariadb server  
```
sudo apt -y install mariadb-server
```
- Restart lại và bật hoạt động mariadb server   
```
sudo systemctl restart mariadb
sudo systemctl enable mariadb
```  
- Kiểm tra trạng thái mariadb server  
```
sudo systemctl status mariadb
```
![alt text](../imgs/8.png)

- Thiết lập lại secure mariadb server 
```
sudo mysql_secure_installation
```
![alt text](../imgs/9.png)

![alt text](../imgs/10.png)


## 2.4.Cài đặt PHP-FPM

- Cài đặt php
```
sudo apt -y install php-fpm
```

- Bật các module tùy chọn 
```
sudo a2enmod proxy_fcgi setenvif
sudo a2enconf php8.1-fpm
```
![alt text](../imgs/11.png)   

- Restart lại php
```
sudo systemctl restart php8.1-fpm apache2
```
- Kiểm tra trạng thái hoạt động của php
```
sudo systemctl status php8.1-fpm
```
- Kiểm tra version php đã cài đặt 
```
php -v
```

## 2.5.Cài đặt zabbix 

**Cài đặt Zabbix**
- Thêm repo Zabbix vào hệ thống Ubuntu 22.04
 
```
wget https://repo.zabbix.com/zabbix/6.0/ubuntu/pool/main/z/zabbix-release/zabbix-release_6.0-4+ubuntu22.04_all.deb

```

![alt text](../imgs/12.png)

- Cài đặt zabbix 
```
sudo dpkg -i zabbix-release_6.0-4+ubuntu22.04_all.deb
```
- Cập nhật lại hệ thống 
```
sudo apt update -y
```

Cài đặt Zabbix Server , Fronted và Agent
```
sudo apt -y install zabbix-server-mysql zabbix-frontend-php zabbix-apache-conf zabbix-sql-scripts zabbix-agent php-mysql php-gd php-bcmath php-net-socket
```

**Thiết lập mariadb, tạo cở sở dữ liệu Zabbix**

mysql -uroot -p
- Tạo Database  
```
create database zabbix character set utf8mb4 collate utf8mb4_bin;
```
- Tạo user và password 
```
create user zabbix@localhost identified by '1';
```
- Phân quyền 
```
grant all privileges on zabbix.* to zabbix@localhost;
set global log_bin_trust_function_creators = 1;
```
flush privileges;
quit;

![alt text](../imgs/13.png)


**Import database mặc định của zabbix**

```
sudo zcat /usr/share/zabbix-sql-scripts/mysql/server.sql.gz | mysql --default-character-set=utf8mb4 -uzabbix -p<1> zabbix
```